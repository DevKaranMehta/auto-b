{% extends "admin/base.html" %}

{% block title %}{% if category %}Edit Category{% else %}New Category{% endif %} - Admin{% endblock %}

{% block content %}
<div class="admin-card">
    <h2 style="margin-bottom: 32px; color: var(--text-primary);">
        <i class="fas fa-{% if category %}edit{% else %}plus{% endif %}"></i>
        {% if category %}Edit Category{% else %}Create New Category{% endif %}
    </h2>

    <form method="POST">
        <div class="form-group">
            <label class="form-label">Name *</label>
            <input type="text" name="name" class="form-control" value="{{ category.name if category else '' }}" required>
        </div>

        <div class="form-group">
            <label class="form-label">Description</label>
            <textarea name="description" class="form-control" rows="3" placeholder="Brief description of this category...">{{ category.description if category else '' }}</textarea>
        </div>

        <div class="form-group">
            <label class="form-label">Color</label>
            <div style="display: flex; gap: 16px; align-items: center;">
                <input type="color" name="color" class="form-control" style="width: 80px; height: 48px; padding: 4px;" value="{{ category.color if category else '#F0B90B' }}">
                <div style="flex: 1;">
                    <input type="text" name="color_hex" class="form-control" placeholder="#F0B90B" value="{{ category.color if category else '#F0B90B' }}" pattern="^#[0-9A-Fa-f]{6}$">
                    <small style="color: var(--text-secondary); margin-top: 4px; display: block;">
                        Choose a color for category badges and highlights
                    </small>
                </div>
            </div>
        </div>

        <div style="margin: 32px 0; padding: 24px; background: var(--bg-secondary); border-radius: 8px;">
            <h4 style="margin-bottom: 16px; color: var(--text-primary);">Preview</h4>
            <div style="display: flex; align-items: center; gap: 16px;">
                <span class="category-badge" id="preview-badge" style="background-color: {{ category.color if category else '#F0B90B' }}33; color: {{ category.color if category else '#F0B90B' }};">
                    {{ category.name if category else 'Category Name' }}
                </span>
                <span style="color: var(--text-secondary);">This is how your category will appear on the website</span>
            </div>
        </div>

        <div style="display: flex; gap: 16px; justify-content: flex-end;">
            <a href="{{ url_for('admin_categories') }}" class="btn" style="background: var(--bg-secondary); color: var(--text-primary);">Cancel</a>
            <button type="submit" class="btn btn-primary">
                {% if category %}Update Category{% else %}Create Category{% endif %}
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const colorInput = document.querySelector('input[type="color"]');
    const hexInput = document.querySelector('input[name="color_hex"]');
    const nameInput = document.querySelector('input[name="name"]');
    const previewBadge = document.getElementById('preview-badge');
    
    function updatePreview() {
        const color = hexInput.value || '#F0B90B';
        const name = nameInput.value || 'Category Name';
        
        previewBadge.style.backgroundColor = color + '33';
        previewBadge.style.color = color;
        previewBadge.textContent = name;
    }
    
    colorInput.addEventListener('input', function() {
        hexInput.value = this.value;
        updatePreview();
    });
    
    hexInput.addEventListener('input', function() {
        if (/^#[0-9A-Fa-f]{6}$/.test(this.value)) {
            colorInput.value = this.value;
            updatePreview();
        }
    });
    
    nameInput.addEventListener('input', updatePreview);
});
</script>
{% endblock %}
