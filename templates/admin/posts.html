{% extends "admin/base.html" %}

{% block title %}Manage Posts{% endblock %}

{% block content %}
<div class="page-header">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
            <h1 class="page-title">Manage Posts</h1>
            <p class="page-subtitle">Create, edit, and manage your blockchain articles</p>
        </div>
        <a href="{{ url_for('admin_new_post') }}" class="btn btn-primary">
            ‚úèÔ∏è Create New Post
        </a>
    </div>
</div>

<div class="card">
    {% if posts %}
    <div class="card-header">
        <h3>All Posts ({{ posts|length }})</h3>
    </div>
    <div class="card-body" style="padding: 0;">
        <table class="table">
            <thead>
                <tr>
                    <th>Title & Details</th>
                    <th>Category</th>
                    <th>Status</th>
                    <th>Stats</th>
                    <th>Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for post in posts %}
                <tr>
                    <td>
                        <div style="font-weight: 600; margin-bottom: 5px;">{{ post.title[:60] }}{% if post.title|length > 60 %}...{% endif %}</div>
                        <div style="color: #666; font-size: 0.9em;">By {{ post.author or 'Admin' }}</div>
                    </td>
                    <td>
                        {% if post.category_name %}
                        <span style="background: #e8f5e8; color: #2e7d32; padding: 4px 8px; border-radius: 4px; font-size: 0.8em;">
                            {{ post.category_name }}
                        </span>
                        {% else %}
                        <span style="color: #999;">No category</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if post.is_published %}
                        <span style="background: #d4edda; color: #155724; padding: 4px 8px; border-radius: 4px; font-size: 0.8em;">Published</span>
                        {% else %}
                        <span style="background: #fff3cd; color: #856404; padding: 4px 8px; border-radius: 4px; font-size: 0.8em;">Draft</span>
                        {% endif %}
                        {% if post.is_featured %}
                        <div style="margin-top: 4px;">
                            <span style="background: #cce5ff; color: #004085; padding: 4px 8px; border-radius: 4px; font-size: 0.8em;">Featured</span>
                        </div>
                        {% endif %}
                    </td>
                    <td>
                        <div style="font-weight: 600;">{{ post.views or 0 }} views</div>
                        <div style="font-size: 0.85em; color: #666;">{{ post.created_at.strftime('%b %d, %Y') }}</div>
                    </td>
                    <td>
                        <div>{{ post.created_at.strftime('%m/%d/%Y') }}</div>
                        <div style="font-size: 0.85em; color: #666;">{{ post.created_at.strftime('%I:%M %p') }}</div>
                    </td>
                    <td>
                        <div style="display: flex; gap: 8px;">
                            <a href="{{ url_for('post_detail', slug=post.slug) }}" target="_blank" class="btn" style="padding: 6px 12px; font-size: 0.8em; background: #e3f2fd; color: #1976d2;">View</a>
                            <a href="{{ url_for('admin_edit_post', id=post.id) }}" class="btn" style="padding: 6px 12px; font-size: 0.8em; background: #f3e5f5; color: #7b1fa2;">Edit</a>
                            <form method="POST" action="{{ url_for('admin_delete_post', id=post.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure?')">
                                <button type="submit" class="btn" style="padding: 6px 12px; font-size: 0.8em; background: #ffebee; color: #c62828; border: none;">Delete</button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="card-body" style="text-align: center; padding: 60px;">
        <div style="font-size: 4em; margin-bottom: 20px; opacity: 0.5;">üìù</div>
        <h3>No posts yet</h3>
        <p>Start creating engaging blockchain content for your readers.</p>
        <a href="{{ url_for('admin_new_post') }}" class="btn btn-primary" style="margin-top: 20px;">Create Your First Post</a>
    </div>
    {% endif %}
</div>
{% endblock %}
